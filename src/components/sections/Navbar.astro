---
import { siteData } from "../../data/siteData";

const { navbarLinks } = siteData;
---

<header
    id="navbar"
    class="fixed top-0 left-0 right-0 z-50 transition-all duration-300 w-full border-b border-solid border-transparent bg-white dark:bg-[#111a22]"
>
    <div
        class="max-w-[1200px] mx-auto px-10 py-4 flex items-center justify-between whitespace-nowrap"
    >
        <div class="flex items-center gap-4 text-primary">
            <div class="size-6">
                <svg
                    fill="none"
                    viewBox="0 0 48 48"
                    xmlns="http://www.w3.org/2000/svg"
                >
                    <path
                        d="M24 4C25.7818 14.2173 33.7827 22.2182 44 24C33.7827 25.7818 25.7818 33.7827 24 44C22.2182 33.7827 14.2173 25.7818 4 24C14.2173 22.2182 22.2182 14.2173 24 4Z"
                        fill="currentColor"></path>
                </svg>
            </div>
            <h2
                class="text-slate-900 dark:text-white text-xl font-bold leading-tight tracking-tight"
            >
                DevPort
            </h2>
        </div>
        <div class="flex flex-1 justify-end gap-8">
            <div class="hidden md:flex items-center gap-9">
                {
                    navbarLinks.map((link) => (
                        <a
                            class="nav-link flex items-center gap-2 text-slate-600 dark:text-slate-300 text-sm font-medium hover:text-primary transition-all duration-300"
                            href={link.href}
                        >
                            {/* Icons mimicking the original hardcoded ones based on label */}
                            {link.label === "Inicio" && (
                                <svg
                                    xmlns="http://www.w3.org/2000/svg"
                                    width="18"
                                    height="18"
                                    viewBox="0 0 24 24"
                                    fill="none"
                                    stroke="currentColor"
                                    stroke-width="2"
                                    stroke-linecap="round"
                                    stroke-linejoin="round"
                                >
                                    <path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z" />
                                    <polyline points="9 22 9 12 15 12 15 22" />
                                </svg>
                            )}
                            {link.label === "Servicios" && (
                                <svg
                                    xmlns="http://www.w3.org/2000/svg"
                                    width="18"
                                    height="18"
                                    viewBox="0 0 24 24"
                                    fill="none"
                                    stroke="currentColor"
                                    stroke-width="2"
                                    stroke-linecap="round"
                                    stroke-linejoin="round"
                                >
                                    <rect
                                        width="20"
                                        height="14"
                                        x="2"
                                        y="7"
                                        rx="2"
                                        ry="2"
                                    />
                                    <path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16" />
                                </svg>
                            )}
                            {link.label === "Portafolio" && (
                                <svg
                                    xmlns="http://www.w3.org/2000/svg"
                                    width="18"
                                    height="18"
                                    viewBox="0 0 24 24"
                                    fill="none"
                                    stroke="currentColor"
                                    stroke-width="2"
                                    stroke-linecap="round"
                                    stroke-linejoin="round"
                                >
                                    <rect
                                        width="7"
                                        height="7"
                                        x="3"
                                        y="3"
                                        rx="1"
                                    />
                                    <rect
                                        width="7"
                                        height="7"
                                        x="14"
                                        y="3"
                                        rx="1"
                                    />
                                    <rect
                                        width="7"
                                        height="7"
                                        x="14"
                                        y="14"
                                        rx="1"
                                    />
                                    <rect
                                        width="7"
                                        height="7"
                                        x="3"
                                        y="14"
                                        rx="1"
                                    />
                                </svg>
                            )}
                            {link.label === "Contacto" && (
                                <svg
                                    xmlns="http://www.w3.org/2000/svg"
                                    width="18"
                                    height="18"
                                    viewBox="0 0 24 24"
                                    fill="none"
                                    stroke="currentColor"
                                    stroke-width="2"
                                    stroke-linecap="round"
                                    stroke-linejoin="round"
                                >
                                    <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z" />
                                </svg>
                            )}
                            {link.label}
                        </a>
                    ))
                }
            </div>
            <a
                href="#contact"
                class="flex min-w-[100px] cursor-pointer items-center justify-center rounded-lg h-10 px-5 bg-primary text-white text-sm font-bold"
            >
                Contactame
            </a>
        </div>
    </div>
</header>
<script>
    // Sticky Navbar Border Effect
    const navbar = document.getElementById("navbar");
    window.addEventListener("scroll", () => {
        if (window.scrollY > 20) {
            navbar?.classList.remove("border-transparent");
            navbar?.classList.add("border-slate-200", "dark:border-slate-800");
        } else {
            navbar?.classList.add("border-transparent");
            navbar?.classList.remove(
                "border-slate-200",
                "dark:border-slate-800",
            );
        }
    });

    // Scrollspy for Navbar
    const sections = document.querySelectorAll("div[id]");
    const navLinks = document.querySelectorAll(".nav-link");

    const scrollSpyObserver = new IntersectionObserver(
        (entries) => {
            entries.forEach((entry) => {
                if (entry.isIntersecting) {
                    const id = entry.target.getAttribute("id");
                    navLinks.forEach((link) => {
                        // Reset
                        link.classList.remove(
                            "text-primary",
                            "font-bold",
                            "bg-slate-100",
                            "dark:bg-slate-800",
                            "rounded-full",
                            "px-4",
                            "py-1",
                        );
                        link.classList.add(
                            "text-slate-600",
                            "dark:text-slate-300",
                            "font-medium",
                        );

                        // Active State (Pill)
                        if (link.getAttribute("href") === `#${id}`) {
                            link.classList.remove(
                                "text-slate-600",
                                "dark:text-slate-300",
                                "font-medium",
                            );
                            link.classList.add(
                                "text-primary",
                                "font-bold",
                                "bg-slate-100",
                                "dark:bg-slate-800",
                                "rounded-full",
                                "px-4",
                                "py-1",
                            );
                        }
                    });
                }
            });
        },
        {
            rootMargin: "-50% 0px -50% 0px",
        },
    );

    sections.forEach((section) => {
        if (["home", "services", "portfolio", "contact"].includes(section.id)) {
            scrollSpyObserver.observe(section);
        }
    });
</script>
